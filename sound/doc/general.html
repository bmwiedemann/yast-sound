<html>
<head>
<title>YaST2 - Sound configuration</title>
</head>

<body bgcolor="white">
<h1>YaST2 - Sound configuration</h1>

<h2>Overview</h2> 
<p>Sound configuration module is used to get working one (or more)
sound cards primary using <a
href="http://www.alsa-project.org">ALSA</a> kernel modules. 

<p>
This document covers and describes current status of the Sound
module (v.2.2.17). Description of the <a href="globals.html">main
global structures</a> that are used is separated. The new
concept is described in another document. <a
href="autodocs/index.html">Complete list</a> of functions with
comments is generated from source.

<p><b>Main configuration steps:</b>
<ul type="circle">
     <li><a href="#reading">Configuration reading and hardware detection</a></li>
     <li><a href="#configuration">Sound card configuration (inserting kernel modules)</a></li>
     <li><a href="#volume">Setting the volume</a></li>
     <li><a href="#saving">Configuration saving</a></li>
</ul>

<a name="reading"></a>
<h3>Configuration reading and hardware detection</h3>
<p>Reading of the previous sound configuration is done by reading:
<ol>
  <li><i>/var/lib/YaST/unique.inf</i></li>
  <li><i>/etc/modules.conf</i></li>
  <li><i>/proc/asound/cards</i></li>
  <li><i>/etc/rc.config</i></li>
</ol>

<p>The first file is a generic file, containing unique keys generated
by libhd. This file contains unique keys of previously YaST2
configured sound cards. The second one contains aliases for sound
modules. Third is a proc output from ALSA system, when some ALSA
modules are loaded, the output says what cards are currently
configured. <i>/etc/rc.config</i> file now contains information about
loading ALSA modules, used by <code>alsasound</code> script.

<p>The main results of configuration reading are:

<ol>
  <li>Is any sound card configured</li>
  <li>What modules which card uses</li>
</ol>

<p>The first is needed for the configuration workflow, the second one
for enabling to remove (delete) this sound card.

<p>Harware detection is done by reading appropriate
<code>.probe</code> path and is provided by libhhd. The detected cards
that are detected are filtered to does not contains already detected
cards. For each detected sound card <i>vendor_id</i> and <i>device_id</i> are
presented to identify the module.

<a name="configuration"></a>
<h3>Sound card configuration (inserting kernel modules)</h3>
<p>For activating non active sound card insertation of appropriate
kernel modules is needed. If some module for detected card is found in
the sound card database than is is used. Otherwise (case of not
detected card) user can select card from the list (which leads to
selection of some module that will be inserted).

<p>The result of module insertation is checked. If the module is
present the configuration continues with <a href="#volume">volume
setting</a>. Otherwise the error message is displayed.

<a name="volume"</a>
<h3>Setting the volume</h3>
<p>For the volume setting appropriate mixer is selected
(<code>amixer</code> for ALSA modules, <code>aumixer</code> for
OSS/Free). For ALSA modules also card number is required.

<a name="saving"</a>
<h3>Configuration saving</h3>
<p>The configuration saving is now implemented to be completeky
separated so it could be simply called with configuration map. The
complete desctiption of the structure that is required by the saving
part of configuration can be found in a <a href="globals.html">data
structure document</a>.


<hr>
<address><a href="mailto:dan@suse.cz">Dan Vesely</a></address>

<!-- hhmts start -->
Last modified: Thu Feb  8 12:58:23 2001
<!-- hhmts end -->
</body>
</html>

